<!-- src/app/components/doctor/dashboard/dashboard.html -->
<div class="doctor-dashboard">
  
    <!-- Header de bienvenue -->
    <mat-card class="welcome-card">
      <mat-card-header>
        <mat-card-title>Bienvenue Dr. {{ currentUser?.name }}</mat-card-title>
        <mat-card-subtitle>Tableau de bord médecin</mat-card-subtitle>
      </mat-card-header>
    </mat-card>
  
    <!-- Statistiques -->
    <div class="stats-grid">
      <mat-card class="stat-card pending">
        <div class="stat-content">
          <mat-icon>schedule</mat-icon>
          <div class="stat-info">
            <h2>{{ statistics.pending }}</h2>
            <p>En attente</p>
          </div>
        </div>
      </mat-card>
  
      <mat-card class="stat-card confirmed">
        <div class="stat-content">
          <mat-icon>check_circle</mat-icon>
          <div class="stat-info">
            <h2>{{ statistics.confirmed }}</h2>
            <p>Confirmés</p>
          </div>
        </div>
      </mat-card>
  
      <mat-card class="stat-card completed">
        <div class="stat-content">
          <mat-icon>done_all</mat-icon>
          <div class="stat-info">
            <h2>{{ statistics.completed }}</h2>
            <p>Terminés</p>
          </div>
        </div>
      </mat-card>
  
      <mat-card class="stat-card today">
        <div class="stat-content">
          <mat-icon>today</mat-icon>
          <div class="stat-info">
            <h2>{{ statistics.todayAppointments }}</h2>
            <p>Aujourd'hui</p>
          </div>
        </div>
      </mat-card>
    </div>
  
    <!-- Liste des rendez-vous -->
    <mat-card class="appointments-card">
      <mat-tab-group>
        
        <!-- Rendez-vous en attente -->
        <mat-tab label="En attente ({{ getAppointmentsByStatus('pending').length }})">
          <div class="appointments-list">
            <div *ngFor="let appointment of getAppointmentsByStatus('pending')" class="appointment-item pending-item">
              <div class="patient-info">
                <h3>{{ appointment.patient?.first_name }} {{ appointment.patient?.last_name }}</h3>
                <p class="appointment-details">
                  {{ formatDate(appointment.appointment_date) }} à {{ formatTime(appointment.appointment_time) }}
                </p>
                <p class="reason" *ngIf="appointment.reason">{{ appointment.reason }}</p>
              </div>
              
              <div class="appointment-actions">
                <button mat-raised-button color="primary" (click)="confirmAppointment(appointment.id)">
                  <mat-icon>check</mat-icon>
                  Confirmer
                </button>
                <button mat-stroked-button color="warn" (click)="rejectAppointment(appointment.id)">
                  <mat-icon>close</mat-icon>
                  Refuser
                </button>
              </div>
            </div>
  
            <div *ngIf="getAppointmentsByStatus('pending').length === 0" class="no-appointments">
              <mat-icon>event_available</mat-icon>
              <p>Aucun rendez-vous en attente</p>
            </div>
          </div>
        </mat-tab>
  
        <!-- Rendez-vous confirmés -->
        <mat-tab label="Confirmés ({{ getAppointmentsByStatus('confirmed').length }})">
          <div class="appointments-list">
            <div *ngFor="let appointment of getAppointmentsByStatus('confirmed')" class="appointment-item confirmed-item">
              <div class="patient-info">
                <h3>{{ appointment.patient?.first_name }} {{ appointment.patient?.last_name }}</h3>
                <p class="appointment-details">
                  {{ formatDate(appointment.appointment_date) }} à {{ formatTime(appointment.appointment_time) }}
                </p>
                <p class="payment-status">
                  Paiement: {{ appointment.payment_status === 'paid' ? 'Payé' : 'En attente' }} 
                  ({{ appointment.payment_amount | number:'1.0-0' }} FCFA)
                </p>
              </div>
              
              <div class="appointment-actions">
                <button mat-stroked-button>
                  <mat-icon>visibility</mat-icon>
                  Détails
                </button>
              </div>
            </div>
  
            <div *ngIf="getAppointmentsByStatus('confirmed').length === 0" class="no-appointments">
              <mat-icon>event_note</mat-icon>
              <p>Aucun rendez-vous confirmé</p>
            </div>
          </div>
        </mat-tab>
  
        <!-- Tous les rendez-vous -->
        <mat-tab label="Tous ({{ appointments.length }})">
          <div class="appointments-list">
            <div *ngFor="let appointment of appointments" class="appointment-item">
              <div class="patient-info">
                <h3>{{ appointment.patient?.first_name }} {{ appointment.patient?.last_name }}</h3>
                <p class="appointment-details">
                  {{ formatDate(appointment.appointment_date) }} à {{ formatTime(appointment.appointment_time) }}
                </p>
                <mat-chip [color]="appointment.status === 'confirmed' ? 'primary' : appointment.status === 'pending' ? 'accent' : 'warn'" selected>
                  {{ getStatusLabel(appointment.status) }}
                </mat-chip>
              </div>
            </div>
          </div>
        </mat-tab>
  
      </mat-tab-group>
    </mat-card>
  
  </div>