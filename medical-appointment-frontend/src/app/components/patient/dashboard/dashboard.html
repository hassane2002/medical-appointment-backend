<!-- src/app/components/patient/dashboard/dashboard.html -->
<div class="dashboard-container">
  
    <!-- Header de bienvenue -->
    <mat-card class="welcome-card">
      <mat-card-header>
        <mat-card-title>Bienvenue, {{ currentUser?.name }}!</mat-card-title>
        <mat-card-subtitle>Trouvez et réservez vos rendez-vous médicaux</mat-card-subtitle>
      </mat-card-header>
    </mat-card>
  
    <!-- Section de recherche -->
    <mat-card class="search-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>search</mat-icon>
          Rechercher un médecin
        </mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <form [formGroup]="searchForm" (ngSubmit)="searchDoctors()" class="search-form">
          
          <div class="form-row">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Spécialité</mat-label>
              <mat-select formControlName="specialty">
                <mat-option value="">Toutes les spécialités</mat-option>
                <mat-option *ngFor="let specialty of specialties" [value]="specialty.name">
                  {{ specialty.name }}
                </mat-option>
              </mat-select>
              <mat-icon matSuffix>medical_services</mat-icon>
            </mat-form-field>
  
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Ville</mat-label>
              <input matInput formControlName="city" placeholder="Ex: Dakar">
              <mat-icon matSuffix>location_city</mat-icon>
            </mat-form-field>
  
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Nom du médecin</mat-label>
              <input matInput formControlName="name" placeholder="Ex: Dr. Diop">
              <mat-icon matSuffix>person_search</mat-icon>
            </mat-form-field>
          </div>
  
          <div class="form-actions">
            <button mat-raised-button 
                    color="primary" 
                    type="submit"
                    [disabled]="isLoading">
              <mat-icon>search</mat-icon>
              Rechercher
            </button>
            
            <button mat-stroked-button 
                    type="button"
                    (click)="resetSearch()"
                    [disabled]="isLoading">
              <mat-icon>refresh</mat-icon>
              Réinitialiser
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  
    <!-- Résultats de recherche -->
    <mat-card class="results-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>people</mat-icon>
          Médecins disponibles ({{ doctors.length }})
        </mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        
        <!-- Loading spinner -->
        <div *ngIf="isLoading" class="loading-container">
          <mat-spinner diameter="50"></mat-spinner>
          <p>Recherche en cours...</p>
        </div>
  
        <!-- Liste des médecins - VERSION SIMPLIFIÉE -->
        <div *ngIf="!isLoading && doctors.length > 0" class="doctors-grid">
          <div *ngFor="let doctor of doctors" class="doctor-card">
            <div class="doctor-info">
              <h3>{{ getDoctorName(doctor) }}</h3>
              <p class="specialty">
                <mat-icon>medical_services</mat-icon>
                {{ getDoctorSpecialty(doctor) }}
              </p>
              <p class="location">
                <mat-icon>location_on</mat-icon>
                {{ getDoctorLocation(doctor) }}
              </p>
              <p class="experience" *ngIf="getDoctorExperience(doctor)">
                <mat-icon>star</mat-icon>
                {{ getDoctorExperience(doctor) }} ans d'expérience
              </p>
              <p class="fee">
                <mat-icon>payments</mat-icon>
                {{ getDoctorFee(doctor) }} FCFA
              </p>
            </div>
            
            <div class="doctor-actions">
              <button mat-raised-button 
                      color="primary"
                      (click)="bookAppointment(doctor)">
                <mat-icon>event</mat-icon>
                Réserver
              </button>
              
              <button mat-stroked-button 
                      (click)="viewDoctorDetails(doctor)">
                <mat-icon>visibility</mat-icon>
                Détails
              </button>
            </div>
            
            <!-- Badge vérifié -->
            <div *ngIf="isDoctorVerified(doctor)" class="verified-badge">
              <mat-icon>verified</mat-icon>
              Vérifié
            </div>
          </div>
        </div>
  
        <!-- Message si aucun résultat -->
        <div *ngIf="!isLoading && doctors.length === 0" class="no-results">
          <mat-icon>search_off</mat-icon>
          <p>Aucun médecin trouvé avec ces critères</p>
          <button mat-stroked-button (click)="resetSearch()">
            Voir tous les médecins
          </button>
        </div>
  
      </mat-card-content>
    </mat-card>
  
  </div>